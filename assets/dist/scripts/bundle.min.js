"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gallery=function(){var n,t,r,e,a,o,l,i,s,c,u,d=document.querySelector(".gallery-images");d&&(n=document.querySelector(".gallery-images-inner"),t=document.querySelector(".gallery-panel"),r=t.querySelector(".panel-image-preview .content-image"),e=document.querySelector("#images-input"),a=null,d.addEventListener("mousedown",function(e){var e=e.target.closest(".content-item");e&&(e=e,r.src=e.dataset.url,a&&a.classList.remove("is-current"),(a=e).classList.add("is-current"))}),o=function(e){_toConsumableArray(e).forEach(function(e){return e=e,(t=new FormData).append("file",e),void fetch("/inc/upload.php",{method:"POST",body:t}).then(function(e){e.json().then(function(e){console.log(e.ok);var t=document.createElement("DIV"),r=(t.className="content-item",t.dataset.url=e.response,document.createElement("IMG"));r.src=e.response,t.appendChild(r),n.prepend(t),c++})}).catch(function(e){});var t})},t.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation(),t.classList.add("gallery-panel-files")}),t.addEventListener("dragenter",function(e){e.preventDefault(),e.stopPropagation(),t.classList.add("gallery-panel-files")}),t.addEventListener("dragleave",function(e){e.preventDefault(),e.stopPropagation(),t.classList.remove("gallery-panel-files")}),t.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation(),t.classList.remove("gallery-panel-files");e=e.dataTransfer.files;o(e)}),e.addEventListener("change",function(){o(e.files)}),l=parseInt(d.dataset.count),i=parseInt(d.dataset.chunks),s=0,c=8,u=d.querySelector(".gallery-load-more .button"),u.addEventListener("click",function(){var e,t,r;t=s+=e=i,(r=new FormData).append("limit",e),r.append("offset",t),fetch("/inc/fetch.php",{method:"POST",body:r}).then(function(e){e.json().then(function(e){e.images&&e.images.forEach(function(e){var t=document.createElement("DIV"),r=(t.className="content-item",t.dataset.url=e.url,document.createElement("IMG"));r.src=e.url,t.appendChild(r),n.appendChild(t),l<=++c&&u.parentNode.remove()})})}).catch(function(e){})}))};window.addEventListener("load",function(){Gallery()});